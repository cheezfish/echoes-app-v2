<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Echoes</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="my-echoes.css"> 
</head>
<body>
    <header>
        <h1>Echoes</h1>
        <div id="user-auth-container">
            <!-- Logged out users see this -->
            <div id="logged-out-view" style="display: none;">
                <button id="login-btn" class="auth-btn">Login</button>
                <button id="register-btn" class="auth-btn">Register</button>
            </div>
            <!-- Logged in users see this -->
            <div id="logged-in-view" style="display: none;">
                <div id="user-menu-button" class="auth-btn">
                    <span id="welcome-message"></span> ▾ <!-- Down arrow character -->
                </div>
                <div id="user-menu-dropdown" style="display: none;">
                    <a href="my-echoes.html">My Echoes</a>
                    <a href="#" id="logout-btn">Logout</a>
                </div>
            </div>
        </div>
    </header>

    <!-- NEW Global Status Bar -->
    <div id="global-status-bar"></div>

    <div id="main-content-grid">
        <main id="map-container">
            <div id="map"></div>
            <!-- NEW Single, Contextual Action Button -->
            <button id="context-action-btn" title="Find My Location"></button>
        </main>
    
        <aside id="nearby-echoes-panel">
            <div class="panel-header">
                <h2>Nearby Echoes</h2>
            </div>
            <div id="nearby-echoes-list">
                <!-- Echoes will be dynamically inserted here -->
            </div>
        </aside>
    </div>
    
    <!-- Auth Modal (contents are essential) -->
    <div id="auth-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <button class="close-btn">×</button>
            <h2 id="modal-title">Login</h2>
            <form id="auth-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <button type="submit" id="modal-submit-btn">Login</button>
                <p id="modal-error" class="error-message"></p>
            </form>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="app.js"></script> 
</body>
</html>